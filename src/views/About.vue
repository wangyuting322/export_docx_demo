<script>
// 引入相关插件
import htmlDocx from 'html-docx-js/dist/html-docx';
import saveAs from 'file-saver';

export default {
    data(){
        return{
            // 页面渲染相关
            image:'@/assets/logo.png',
            content:'',
            page:'', 
        }
    },
  methods: {
    exportDocx() {

      this.content = ` 
      <div><div style="text-align:center"><table cellspacing="0" cellpadding="0" style="margin-right:auto; margin-left:auto; border-collapse:collapse"><tr style="height:27.6pt"><td colspan="12" style="width:455.65pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; text-align:center; font-size:11pt"><a name="RANGE_A1_H31"><span style="font-family:'宋体'; font-weight:bold">温岭甬岭水表</span><span style="font-family:'宋体'; font-weight:bold">有限公司</span></a></p></td></tr><tr style="height:20.25pt"><td colspan="12" style="width:455.65pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; text-align:center; font-size:10.5pt"><span style="font-family:'宋体'; font-weight:bold">生产任务通知单</span></p></td></tr><tr style="height:20.55pt"><td colspan="3" style="width:111.6pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">Q/YL03-05</span><span style="font-family:'宋体'">&#xa0;</span><span style="font-family:'宋体'">&#xa0;</span><span style="font-family:'宋体'"> </span><span style="font-family:'宋体'">版次</span><span style="font-family:'宋体'">: B-0</span></p></td><td colspan="4" style="width:122.35pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td><td colspan="2" style="width:45.6pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">编号</span></p></td><td colspan="3" style="width:145.8pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td></tr><tr style="height:20.8pt"><td style="width:52.6pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'; font-weight:bold">发文部门</span></p></td><td colspan="3" style="width:88.2pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">销售部</span></p></td><td colspan="3" style="width:83.05pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'; font-weight:bold">受</span><span style="font-family:'宋体'; font-weight:bold">文部门</span></p></td><td colspan="5" style="width:201.5pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">生产中心，技术中心，品管部</span></p></td></tr><tr style="height:13.3pt"><td style="width:52.6pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'; font-weight:bold">订单编号</span></p></td><td colspan="3" style="width:88.2pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td><td colspan="3" style="width:83.05pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'; font-weight:bold">要求完成日期</span></p></td><td colspan="5" style="width:201.5pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td></tr><tr style="height:20.5pt"><td style="width:52.6pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'; font-weight:bold">物料编码</span></p></td><td colspan="2" style="width:48.9pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'; font-weight:bold">产品名称</span></p></td><td style="width:29.2pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'; font-weight:bold">规格型号</span></p></td><td style="width:35.3pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'; font-weight:bold">单位</span></p></td><td colspan="3" style="width:39.05pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'; font-weight:bold">数量</span></p></td><td style="width:44.2pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'; font-weight:bold">包装方式</span></p></td><td colspan="2" style="width:60.75pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'; font-weight:bold">开始表号</span></p></td><td style="width:74.95pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'; font-weight:bold">结束表号</span></p></td></tr><tr style="height:16.05pt"><td style="width:52.6pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td><td colspan="2" style="width:48.9pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td><td style="width:29.2pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td><td style="width:35.3pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td><td colspan="3" style="width:39.05pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td><td style="width:44.2pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td><td colspan="2" style="width:60.75pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td><td style="width:74.95pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td></tr><tr style="height:16.5pt"><td colspan="12" style="width:455.65pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; text-align:center; font-size:10.5pt"><span style="font-family:'宋体'">其</span><span style="font-family:'宋体'">&#xa0;</span><span style="font-family:'宋体'">&#xa0;</span><span style="font-family:'宋体'"> </span><span style="font-family:'宋体'">他</span><span style="font-family:'宋体'">&#xa0;</span><span style="font-family:'宋体'">&#xa0;</span><span style="font-family:'宋体'"> </span><span style="font-family:'宋体'">要</span><span style="font-family:'宋体'">&#xa0;</span><span style="font-family:'宋体'">&#xa0;</span><span style="font-family:'宋体'"> </span><span style="font-family:'宋体'">求</span></p></td></tr><tr style="height:41.95pt"><td colspan="12" style="width:455.65pt; border-style:solid; border-width:0.75pt; padding-right:4.68pt; padding-left:4.68pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td></tr><tr style="height:27.05pt"><td colspan="2" style="width:106.3pt; border-top-style:solid; border-top-width:0.75pt; padding-right:5.05pt; padding-left:5.05pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; text-align:center; font-size:10.5pt"><span style="font-family:'宋体'">制单/日期</span></p></td><td colspan="4" style="width:116.45pt; border-top-style:solid; border-top-width:0.75pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; text-align:center; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td><td colspan="4" style="width:116.45pt; border-top-style:solid; border-top-width:0.75pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; text-align:center; font-size:10.5pt"><span style="font-family:'宋体'">批准/日期</span></p></td><td colspan="2" style="width:116.45pt; border-top-style:solid; border-top-width:0.75pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; text-align:center; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td></tr><tr style="height:27.05pt"><td colspan="2" style="width:106.3pt; padding-right:5.05pt; padding-left:5.05pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; text-align:center; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td><td colspan="4" style="width:116.45pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; text-align:center; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td><td colspan="4" style="width:116.45pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; text-align:center; font-size:12pt"><span style="font-family:'宋体'">技术中心确认/日期</span></p></td><td colspan="2" style="width:116.45pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; text-align:center; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td></tr><tr style="height:25.15pt"><td colspan="2" style="width:106.3pt; padding-right:5.05pt; padding-left:5.05pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; text-align:center; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td><td colspan="4" style="width:116.45pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; text-align:center; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td><td colspan="4" style="width:116.45pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; text-align:center; font-size:10.5pt"><span style="font-family:'宋体'">生产中心确认/日期</span></p></td><td colspan="2" style="width:116.45pt; vertical-align:top"><p style="margin-top:0pt; margin-bottom:0pt; text-align:center; font-size:10.5pt"><span style="font-family:'宋体'">&#xa0;</span></p></td></tr><tr style="height:0pt"><td style="width:62.7pt"></td><td style="width:53.7pt"></td><td style="width:5.3pt"></td><td style="width:39.3pt"></td><td style="width:45.4pt"></td><td style="width:26.45pt"></td><td style="width:21.3pt"></td><td style="width:1.4pt"></td><td style="width:54.3pt"></td><td style="width:39.45pt"></td><td style="width:31.4pt"></td><td style="width:85.05pt"></td></tr></table></div><p style="margin-top:0pt; margin-bottom:0pt; text-align:right; font-size:10.5pt"><span style="font-family:'宋体'">:</span></p></div>
      `;
      this.page = `
      <!DOCTYPE html><html><head><meta charset="UTF-8"></head><body>${this.content}</body></html>
      `;
      const converted = htmlDocx.asBlob(this.page);
      // 用 FielSaver.js里的保存方法 进行输出
      saveAs(converted, 'test.docx');
    }
  },
  render() {
    return (
      <div class="about">
        <button onClick={this.exportDocx}>文件导出</button>
      </div>
    )
  }
}
</script>